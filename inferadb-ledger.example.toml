# InferaDB Ledger Configuration
#
# Copy to inferadb-ledger.toml and adjust for your environment.
# Environment variables override with INFERADB__LEDGER__ prefix
# (e.g., INFERADB__LEDGER__BOOTSTRAP__MIN_CLUSTER_SIZE=3).

# === Required ===

listen_addr = "0.0.0.0:50051"    # gRPC listen address
data_dir = "/var/lib/ledger"     # Data directory for Raft logs and state

# === Bootstrap Configuration ===
#
# Controls coordinated cluster formation. Multiple nodes discover each other,
# exchange node info, and the node with the lowest Snowflake ID bootstraps
# the cluster while others wait to join.

[bootstrap]
# Minimum nodes required before cluster formation begins.
# Default: 3 (prevents accidental single-node production deployments)
min_cluster_size = 3

# Maximum time (seconds) to wait for min_cluster_size peers.
# Returns error if timeout expires before enough peers discovered.
# Default: 60
bootstrap_timeout_secs = 60

# Interval (seconds) between discovery polls during bootstrap.
# Default: 2
poll_interval_secs = 2

# Required when min_cluster_size = 1 to prevent accidental single-node deployments.
# Set to true for development or intentional single-node mode.
# Default: false
# allow_single_node = true

# Skip coordination algorithm (for testing/legacy compatibility).
# When true, node bootstraps alone if no peers found, or waits for JoinCluster RPC.
# Default: false
# skip_coordination = true

# === Optional (defaults shown) ===

# metrics_addr = "0.0.0.0:9090"  # Prometheus endpoint (disabled if not set)

# [batching]
# max_batch_size = 100           # Max transactions per batch
# max_batch_delay_ms = 10        # Max wait time for batch to fill (ms)

# [rate_limit]
# max_concurrent = 100           # Max concurrent requests per connection
# timeout_secs = 30              # Request timeout

# [discovery]
# srv_domain = "cluster.example.com"  # DNS SRV for peer discovery (_ledger._tcp.<domain>)
# cached_peers_path = "/var/lib/ledger/peers.cache"
# cache_ttl_secs = 3600          # Cache TTL (1 hour)
